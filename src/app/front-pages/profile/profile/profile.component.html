<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet">

<div class="container">
    <div class="row">
        <!-- Profile Picture Card -->
        <div class="col-xs-12 col-md-4 col-lg-3 mb-4">
            <div class="card text-center">
                <div class="card-body">
                    <div class="image">
                        <img [src]="user?.profilePictureUrl" alt="#" class="img-fluid rounded-circle">
                        <a (click)="openModal()" title="#" class="editImage">
                            <i class="fa fa-camera"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- User Info Card -->
        <div class="col-xs-12 col-md-8 col-lg-9 mb-4">
            <div class="card">
                <div class="card-body">
                    <div class="name d-flex align-items-center mb-3">
                        <strong>{{ user?.username }}</strong>
                        <a (click)="openModal2()" title="#" class="ml-2">
                            <i class="fa fa-pencil"></i>
                        </a>
                    </div>
                    <div class="info">
                        <div class="mb-2">
                            <i class="fa fa-fw fa-clock-o"></i> 
                            <a href="tel:+4210555888777" title="#">{{ user?.phone }}</a>
                        </div>
                        <div class="mb-2">
                            <i class="fa fa-fw fa-list-alt"></i> 
                            <a href="#" title="#">{{ user?.email }}</a>
                        </div>
                        <div class="mb-2">
                            <i class="fa fa-fw fa-usd"></i> 
                            {{ user?.adresse }}
                        </div>
                        <a (click)="openModal3()" title="#" class="btn btn-link p-0">Changer MDP</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal HTML (Profile Picture) -->
<div #profilePictureModal class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Update Profile Picture</h5>
                <button type="button" class="close" aria-label="Close" (click)="closeModal()">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <input type="file" (change)="onFileSelected($event)">
            </div>
            <div class="modal-body">
                <button type="button" class="btn btn-primary" (click)="updateProfilePicture()">Save changes</button>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" (click)="closeModal()">Close</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal 2 HTML (Update Profile Info) -->
<div #updateprofile class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Update Profile</h5>
                <button type="button" class="close" aria-label="Close" (click)="closeModal2()">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form (ngSubmit)="onUpdateUser()">
                    <div class="form-group">
                        <label for="username">Name</label>
                        <input type="text" class="form-control" id="username" [(ngModel)]="updateUserDTO.username" name="username" />
                    </div>
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="text" class="form-control" id="email" [(ngModel)]="updateUserDTO.email" name="email" />
                    </div>
                    <div class="form-group">
                        <label for="phone">Phone</label>
                        <input type="text" class="form-control" id="phone" [(ngModel)]="updateUserDTO.phone" name="phone" />
                    </div>
                    <div class="form-group">
                        <label for="adresse">Adresse</label>
                        <input type="text" class="form-control" id="adresse" [(ngModel)]="updateUserDTO.adresse" name="adresse" />
                    </div>
                    <button type="submit" class="btn btn-primary" (click)="onUpdateUser()">Enregistrer</button>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" (click)="closeModal2()">Close</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal 3 HTML (Change Password) -->
<div #resetmdp class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Changer Mot de Passe</h5>
                <button type="button" class="close" aria-label="Close" (click)="closeModal3()">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="form-group">
                        <label for="oldPassword">Ancien Mot de Passe</label>
                        <input type="password" id="oldPassword" [(ngModel)]="oldPassword" name="oldPassword" required>
                    </div>
                    <div class="form-group">
                        <label for="newPassword">Nouveau Mot de Passe</label>
                        <input type="password" id="newPassword" [(ngModel)]="newPassword" name="newPassword" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" (click)="changePassword()">Enregistrer</button>
                <button type="button" class="btn btn-secondary" (click)="closeModal3()">Close</button>
            </div>
            <p>{{ message }}</p>
        </div>
    </div>
</div>

<style>
body {
    margin-top: 40px;
    min-height: 100%;
    background: #ebecf2;
}
.card {
    border: none;
    border-radius: 10px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}
.card .image {
    position: relative;
}
.card .image .editImage {
    position: absolute;
    bottom: -20px;
    right: 20px;
    background: #fe5621;
    color: #fff;
    text-align: center;
    font-size: 18px;
    width: 40px;
    height: 40px;
    line-height: 40px;
    border-radius: 50%;
}
.card .image .editImage:hover {
    background: #fe693a;
}
</style>
