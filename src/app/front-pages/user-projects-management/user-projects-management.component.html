<section class="user-projects container my-5">
  <h2 class="text-center mb-4">My Projects</h2>
  <div class="text-right mb-4">
    <button class="btn btn-primary" (click)="openCreateForm()">Create New Project</button>
  </div>
  <div class="row">
    <div class="col-md-4 mb-4" *ngFor="let project of projects">
      <div class="card h-100 project-card">
        <div class="card-body">
          <h1 class="card-title">{{ project.title }}</h1>
          <p class="card-text">{{ project.description }}</p>
          <p class="card-text">Skills Required: {{ project.skillsRequired }}</p>
          <p class="card-text">Budget: {{ project.budget | currency }}</p>
          <p class="card-text">Deadline: {{ project.deadline | date }}</p>
          <p class="card-text">Number of Propositions: {{ project.nbPropositions }}</p>
          <button class="btn btn-warning" (click)="openEditForm(project)">Edit</button>
          <button class="btn btn-danger" (click)="deleteProject(project.id)">Delete</button>
          <button class="btn btn-info" (click)="openDetails(project)">Details</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Project Form Modal -->
  <div *ngIf="showModal" class="modal">
    <div class="modal-content">
      <span class="close" (click)="closeForm()">&times;</span>
      <form [formGroup]="projectForm" (ngSubmit)="saveProject()">
        <div class="form-group">
          <label for="title">Title</label>
          <input type="text" id="title" formControlName="title" class="form-control" />
        </div>
        <div class="form-group">
          <label for="description">Description</label>
          <textarea id="description" formControlName="description" class="form-control"></textarea>
        </div>
        <div class="form-group">
          <label for="category">Category</label>
          <select id="category" formControlName="category" class="form-control">
            <option *ngFor="let category of categories" [value]="category">{{ category }}</option>
          </select>
        </div>
        <div class="form-group">
          <label for="skillsRequired">Skills Required</label>
          <input type="text" id="skillsRequired" formControlName="skillsRequired" class="form-control" />
        </div>
        <div class="form-group">
          <label for="deadline">Deadline</label>
          <input type="date" id="deadline" formControlName="deadline" class="form-control" />
        </div>
        <div class="form-group">
          <label for="budget">Budget</label>
          <input type="number" id="budget" formControlName="budget" class="form-control" />
        </div>
        <button type="submit" class="btn btn-primary">{{ isEditing ? 'Update' : 'Create' }}</button>
      </form>
    </div>
  </div>

  <!-- Propositions Modal -->
  <div *ngIf="showPropositionsModal" class="modal">
    <div class="modal-content">
      <span class="close" (click)="closePropositionsModal()">&times;</span>
      <h3>Propositions for {{ selectedProject?.title }}</h3>
      <ul>
        <li *ngFor="let proposition of propositions">
          <p>{{ proposition.detail }}</p>
          <p>Amount: {{ proposition.amount | currency }}</p>
          <p>Status: {{ proposition.status }}</p>
          <button class="btn btn-success" (click)="approveProposition(proposition.id)">Approve</button>
          <button class="btn btn-danger" (click)="declineProposition(proposition.id)">Decline</button>
        </li>
      </ul>
    </div>
  </div>
</section>
